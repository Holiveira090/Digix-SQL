CREATE TABLE PESSOA (
    NOME VARCHAR(50),
    CPF INTEGER PRIMARY KEY NOT NULL
);

CREATE TABLE ENGENHEIRO (
    CREA INTEGER PRIMARY KEY NOT NULL,
    NOME VARCHAR(50),
    CPF_PESSOA INTEGER NOT NULL,
    CONSTRAINT FK_CPF FOREIGN KEY (CPF_PESSOA) REFERENCES PESSOA(CPF)
);

CREATE TABLE UNIDADE_RESIDENCIAL (
    ID_RESIDENCIAL INT PRIMARY KEY NOT NULL,
    METRAGEM_UNIDADE FLOAT,
    NUM_QUARTOS INT,
    NUM_BANHEIROS INT,
    PROPRIETARIO_CPF INT NOT NULL,
    CONSTRAINT FK_PROPRIETARIO FOREIGN KEY (PROPRIETARIO_CPF) REFERENCES PESSOA(CPF)
);

CREATE TABLE EDIFICACAO (
    ID_EDIFICACAO INT PRIMARY KEY NOT NULL,
    METRAGEM_TOTAL FLOAT,
    ENDERECO VARCHAR(100),
    RESPONSAVEL_ENG INT NOT NULL,
    FK_UNIDADE INT NOT NULL,
    CONSTRAINT FK_ENG FOREIGN KEY (RESPONSAVEL_ENG) REFERENCES ENGENHEIRO(CREA),
    CONSTRAINT FK_UNIDADE FOREIGN KEY (FK_UNIDADE) REFERENCES UNIDADE_RESIDENCIAL(ID_RESIDENCIAL)
);

CREATE TABLE PREDIO (
    ID_PREDIO INT PRIMARY KEY NOT NULL,
    NOME VARCHAR(50),
    NUM_ANDARES INT,
    AP_POR_ANDAR INT,
    FK_EDIFICACAO INT NOT NULL,
    CONSTRAINT FK_EDIFICACAO FOREIGN KEY (FK_EDIFICACAO) REFERENCES EDIFICACAO(ID_EDIFICACAO)
);
CREATE TABLE CASA (
    ID_CASA INT PRIMARY KEY NOT NULL,
    CONDOMINIO BOOLEAN,
    FK_EDIFICACAO INT NOT NULL,
    CONSTRAINT FK_EDIFICACAO FOREIGN KEY (FK_EDIFICACAO) REFERENCES EDIFICACAO(ID_EDIFICACAO)
);
CREATE TABLE CASA_TERREA (
    ID_CASA INT PRIMARY KEY NOT NULL,
    CONDOMINIO BOOLEAN,
    FK_EDIFICACAO INT NOT NULL,
    CONSTRAINT FK_EDIFICACAO FOREIGN KEY (FK_EDIFICACAO) REFERENCES EDIFICACAO(ID_EDIFICACAO)
);
CREATE TABLE CASA_SOBRADO (
    ID_CASA INT PRIMARY KEY NOT NULL,
    CONDOMINIO BOOLEAN,
    NUM_ANDARES INT,
    FK_EDIFICACAO INT NOT NULL,
    CONSTRAINT FK_EDIFICACAO FOREIGN KEY (FK_EDIFICACAO) REFERENCES EDIFICACAO(ID_EDIFICACAO)
);

-- Inserindo dados na tabela PESSOA
INSERT INTO PESSOA (NOME, CPF) VALUES ('João Silva', 123456789);
INSERT INTO PESSOA (NOME, CPF) VALUES ('Maria Oliveira', 987654321);
INSERT INTO PESSOA (NOME, CPF) VALUES ('Carlos Souza', 456789123);

-- Inserindo dados na tabela ENGENHEIRO
INSERT INTO ENGENHEIRO (CREA, NOME, CPF_PESSOA) VALUES (1111, 'Eng. João Silva', 123456789);
INSERT INTO ENGENHEIRO (CREA, NOME, CPF_PESSOA) VALUES (2222, 'Eng. Maria Oliveira', 987654321);
INSERT INTO ENGENHEIRO (CREA, NOME, CPF_PESSOA) VALUES (3333, 'Eng. Carlos Souza', 456789123);

-- Inserindo dados na tabela UNIDADE_RESIDENCIAL
INSERT INTO UNIDADE_RESIDENCIAL (ID_RESIDENCIAL, METRAGEM_UNIDADE, NUM_QUARTOS, NUM_BANHEIROS, PROPRIETARIO_CPF) 
VALUES (1, 70.5, 2, 1, 123456789);
INSERT INTO UNIDADE_RESIDENCIAL (ID_RESIDENCIAL, METRAGEM_UNIDADE, NUM_QUARTOS, NUM_BANHEIROS, PROPRIETARIO_CPF) 
VALUES (2, 85.0, 3, 2, 987654321);
INSERT INTO UNIDADE_RESIDENCIAL (ID_RESIDENCIAL, METRAGEM_UNIDADE, NUM_QUARTOS, NUM_BANHEIROS, PROPRIETARIO_CPF) 
VALUES (3, 120.0, 4, 3, 456789123);

-- Inserindo dados na tabela EDIFICACAO
INSERT INTO EDIFICACAO (ID_EDIFICACAO, METRAGEM_TOTAL, ENDERECO, RESPONSAVEL_ENG, FK_UNIDADE) 
VALUES (1, 500.0, 'Rua A, 123', 1111, 1);
INSERT INTO EDIFICACAO (ID_EDIFICACAO, METRAGEM_TOTAL, ENDERECO, RESPONSAVEL_ENG, FK_UNIDADE) 
VALUES (2, 750.0, 'Rua B, 456', 2222, 2);
INSERT INTO EDIFICACAO (ID_EDIFICACAO, METRAGEM_TOTAL, ENDERECO, RESPONSAVEL_ENG, FK_UNIDADE) 
VALUES (3, 900.0, 'Rua C, 789', 3333, 3);

-- Inserindo dados na tabela PREDIO
INSERT INTO PREDIO (ID_PREDIO, NOME, NUM_ANDARES, AP_POR_ANDAR, FK_EDIFICACAO) 
VALUES (1, 'Edifício Alfa', 10, 4, 1);
INSERT INTO PREDIO (ID_PREDIO, NOME, NUM_ANDARES, AP_POR_ANDAR, FK_EDIFICACAO) 
VALUES (2, 'Edifício Beta', 15, 3, 2);
INSERT INTO PREDIO (ID_PREDIO, NOME, NUM_ANDARES, AP_POR_ANDAR, FK_EDIFICACAO) 
VALUES (3, 'Edifício Gama', 20, 2, 3);

-- Inserindo dados na tabela CASA
INSERT INTO CASA (ID_CASA, CONDOMINIO, FK_EDIFICACAO) 
VALUES (1, TRUE, 1);
INSERT INTO CASA (ID_CASA, CONDOMINIO, FK_EDIFICACAO) 
VALUES (2, FALSE, 2);
INSERT INTO CASA (ID_CASA, CONDOMINIO, FK_EDIFICACAO) 
VALUES (3, TRUE, 3);

-- Inserindo dados na tabela CASA_TERREA
INSERT INTO CASA_TERREA (ID_CASA, CONDOMINIO, FK_EDIFICACAO) 
VALUES (1, TRUE, 1);
INSERT INTO CASA_TERREA (ID_CASA, CONDOMINIO, FK_EDIFICACAO) 
VALUES (2, FALSE, 2);
INSERT INTO CASA_TERREA (ID_CASA, CONDOMINIO, FK_EDIFICACAO) 
VALUES (3, TRUE, 3);

-- Inserindo dados na tabela CASA_SOBRADO
INSERT INTO CASA_SOBRADO (ID_CASA, CONDOMINIO, NUM_ANDARES, FK_EDIFICACAO) 
VALUES (1, TRUE, 2, 1);
INSERT INTO CASA_SOBRADO (ID_CASA, CONDOMINIO, NUM_ANDARES, FK_EDIFICACAO) 
VALUES (2, FALSE, 3, 2);
INSERT INTO CASA_SOBRADO (ID_CASA, CONDOMINIO, NUM_ANDARES, FK_EDIFICACAO) 
VALUES (3, TRUE, 4, 3);

-- 1. listar todas as unidades residencias com seu proprietarios e endereços
SELECT u.ID_RESIDENCIAL as UNIDADE_RESIDENCIAL, p.nome as proprietario, E.ENDERECO
FROM unidade_residencial U
JOIN pessoa P ON proprietario_cpf = cpf
JOIN edificacao E ON id_residencial = fk_unidade

-- 2. listar todas as unidades residenciais com seus proprietarios e endereços, ordenando por metragem da unidade
SELECT u.metragem_unidade as METRAGEM, u.ID_RESIDENCIAL as UNIDADE_RESIDENCIAL, p.nome as proprietario, E.ENDERECO
FROM unidade_residencial U
JOIN pessoa P ON proprietario_cpf = cpf
JOIN edificacao E ON id_residencial = fk_unidade
ORDER BY U.metragem_unidade